# bosk

[[English version]](README_EN.md)

Bosk - это фреймворк для создания моделей Глубоких лесов, написанный на языке Python. Совместим с [scikit-learn](https://scikit-learn.org).

## О фреймворке

Опираясь на общеупотребимый способ описания моделей машинного обучения
в фреймворках, модели внутри bosk представляют из себя вычислительные графы
общего вида и не имеют строго определенной многослойной структуры, присущей Глубоким лесам.
В bosk каждая модель инкапсулирует в себе два различных вычислительных
графа: первый отвечает за стадию обучения модели, второй - предсказания.

Bosk позволяет разрабатывать новые архитектуры глубоких
лесов, не прибегая к написанию подверженного ошибкам монотонного рутинного кода,
а также содержит полезные инструменты для выполнения и отладки вычислительных графов.
Помимо этого, в bosk представлено большое количество готовых к использованию
стандартных исполнительных блоков.
Фреймворк поддерживает как ручное задание вычислительного графа Глубокого леса,
так и его автоматическое построение в формате слой за слоем.

## Установка

Необходим Python версии не ниже 3.9.

### Установка JAX

В Bosk используется библиотека JAX для выполнения вывчислений на ГПУ, однако ее установка не тривиальна. Официально JAX распространяется только для Linux и Mac OS, поэтому, к сожалению,
пользователям Windows следует использовать `WSL <https://docs.microsoft.com/en-us/windows/wsl/about>`_ 
для установки JAX и использования bosk с поддержкой вычислений на ГПУ.

**Установка только для ЦПУ**

Если на Вашей системе нет графического процессора, Вы можете установить версию JAX для ЦПУ:

    pip install --upgrade "jax[cpu]==0.4.10"

**Установка с поддержкой вычислений на ГПУ**

Если Вы заинтересованы в установке bosk с поддержкой вычислений на ГПУ, пожалуйста, прочитайте наше [руководство по установке](https://ntailab.github.io/bosk/ru_install.html#jax-installation) в документации.

### Установка пакета

Для установки пакета bosk напрямую из GitHub выполните:

    pip install git+ssh://git@github.com:NTAILab/bosk.git

Также Вы можете вручную скопировать репозиторий и установить bosk:

    git clone git@github.com:NTAILab/bosk.git
    cd bosk
    pip install -r requirements.txt
    python setup.py install

### Примеры

Для краткого обзора возможностей фреймворка предлагается создать однослойный Глубокий лес, содержащий в себе два вида лесов: случайный лес (Random Forest) и модель сверхслучайных деревьев (Extremely Randomized Trees). Вероятности, предсказанные обоими моделями, будут сконкатенированы с вектором входных признаков и переданы в финальный лес. 

```python
# создание построителя конвейера
b = FunctionalPipelineBuilder()
# блоки для маршрутизации входных данных:
# `x` для вектора факторов и `y`
# для откликов
x = b.Input('x')()
y = b.TargetInput('y')()
# блоки моделей лесов
random_forest = b.RFC(max_depth=5)
extra_trees = b.ETC(n_estimators=200)
# блок конкатенации
cat = b.Concat(['x', 'rf', 'et'])
# слой, конкатенирующий выходные векторы лесов
# и вектор входных признаков
layer_1 = cat(x=x, rf=rf(X=x, y=y), et=extra_trees(X=x, y=y))
# лес для осуществления итогового предсказания
final_extra_trees = b.ETC()
# выход конвейера
b.Output('proba')(final_extra_trees(X=layer_1, y=y))
# создание конвейера
pipeline = b.build()

# scikit-learn обертка для конвейера
model = BoskPipelineClassifier(pipeline, executor_cls=RecursiveExecutor)
# обучаем модель
model.fit(X_train, y_train)
# осуществляем предсказание
test_preds = model.predict(X_test)
```

Для того, чтобы увидеть больше примеров, Вы можете обратиться к нашей [документации](https://ntailab.github.io/bosk/ru_examples.html). Также Вы можете найти Jupyter блокноты с примерами в  [папке с примерами](examples/).

### Документация

Больше информации о bosk Вы можете найти в нашей [документации](https://ntailab.github.io/bosk/index.html)

### Как стать участником проекта

Мы всегда рады вкладу сообщества в наш проект. Пожалуйста, прочитайте [инструкцию](https://ntailab.github.io/bosk/ru_contribution.html), чтобы узнать, как стать участником bosk.
